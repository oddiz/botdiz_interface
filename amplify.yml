version: 1
frontend:
    phases:
        preBuild:
            commands:
                - echo "registry=https://registry.npmjs.org/" > .npmrc
                - echo "@dracula:registry=https://npm.pkg.github.com/" >> .npmrc
                - echo "//registry.npmjs.org/:_authToken=${NPM_TOKEN}" >> .npmrc
                - echo 'REACT_APP_RECAPTCHA_SITEKEY="${REACT_APP_RECAPTCHA_SITEKEY}"' > .env
                - cat .npmrc
                - pwd
                - yarn install
        build:
            commands:
                - yarn run build
        artifacts:
            baseDirectory: build
            files:
                - '**/*'
        cache:
            paths:
                - node_modules/**/*